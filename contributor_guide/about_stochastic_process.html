
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Stochastic process sampling &#8212; ReLife</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=da1e0c12" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'contributor_guide/about_stochastic_process';</script>
    <script src="../_static/custom-icon.js?v=74687d30"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Lectures" href="additional_lectures.html" />
    <link rel="prev" title="About integrations" href="about_integration.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class=" navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/pixel_full_logo_clip.png" class="logo__image only-light" alt="ReLife - Home"/>
    <img src="../_static/pixel_full_logo_clip.png" class="logo__image only-dark pst-js-only" alt="ReLife - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class=" navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../get_started/index.html">
    Get started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/index.html">
    API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user_guide/index.html">
    User’s guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../learn/index.html">
    Learn
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button"
                data-bs-toggle="dropdown" aria-expanded="false"
                aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" current active">
  <a class="nav-link dropdown-item nav-internal" href="index.html">
    Contributor’s guide
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../future/index.html">
    Future improvements
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/rte-france/relife/tree/refactoring" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/relife/" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-custom fa-pypi fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../get_started/index.html">
    Get started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/index.html">
    API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user_guide/index.html">
    User’s guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../learn/index.html">
    Learn
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    Contributor’s guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../future/index.html">
    Future improvements
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/rte-france/relife/tree/refactoring" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/relife/" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-custom fa-pypi fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">First time contribution</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="your_profile.html">What is your profile ?</a></li>
<li class="toctree-l1"><a class="reference internal" href="development_env.html">Developement environment</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Conception of ReLife2</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="about_numpy.html">About numpy</a></li>
<li class="toctree-l1"><a class="reference internal" href="about_lifetime_models.html">About lifetime models</a></li>
<li class="toctree-l1"><a class="reference internal" href="about_integration.html">About integrations</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Stochastic process sampling</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Python resources</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="additional_lectures.html">Lectures</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Contributor’s guide</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Stochastic process sampling</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="stochastic-process-sampling">
<h1>Stochastic process sampling<a class="headerlink" href="#stochastic-process-sampling" title="Link to this heading">#</a></h1>
<p>Suppose we want to sample lifetimes given an <code class="docutils literal notranslate"><span class="pre">end_time</span></code> and a sampling
<code class="docutils literal notranslate"><span class="pre">size</span></code>. The first and easiest way to visualize the sampling process is
to consider one asset :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="o">-&gt;</span> <span class="n">samples_index</span>
<span class="o">-----</span>
<span class="mi">4</span> <span class="mi">2</span> <span class="mi">4</span> <span class="o">-&gt;</span> <span class="n">it</span><span class="mf">.1</span>
<span class="mi">1</span> <span class="mi">5</span> <span class="mi">2</span> <span class="o">-&gt;</span> <span class="n">it</span><span class="mf">.2</span>
<span class="mi">2</span> <span class="mi">4</span> <span class="mi">3</span> <span class="o">-&gt;</span> <span class="n">it</span><span class="mf">.3</span>
<span class="mi">2</span> <span class="o">.</span> <span class="mi">2</span> <span class="o">-&gt;</span> <span class="n">it</span><span class="mf">.4</span>
<span class="mi">3</span> <span class="o">.</span> <span class="o">.</span> <span class="o">-&gt;</span> <span class="n">it</span><span class="mf">.5</span>
<span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">-&gt;</span> <span class="ne">StopIteration</span>
</pre></div>
</div>
<p>As you can see, the sampling generates a sequence of lifetime values per
sample index (here <code class="docutils literal notranslate"><span class="pre">size</span></code> = 3). The sequences generated vary in length
depending on whether the cumulative sum of the durations has reached the
time limit (here <code class="docutils literal notranslate"><span class="pre">end_time</span></code>=10).</p>
<p>Sometimes, one wants to generate lifetimes for different assets. In that
case, the number of sequences equals the <code class="docutils literal notranslate"><span class="pre">size</span> <span class="pre">*</span> <span class="pre">nb_assets</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">2</span> <span class="o">-&gt;</span> <span class="n">samples_index</span>
<span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="o">-&gt;</span> <span class="n">assets_index</span>
<span class="o">-----</span>
<span class="mi">4</span> <span class="mi">2</span> <span class="mi">4</span> <span class="mi">2</span> <span class="mi">5</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">4</span> <span class="mi">7</span> <span class="o">-&gt;</span> <span class="n">it</span><span class="mf">.1</span>
<span class="mi">1</span> <span class="mi">5</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">6</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">4</span> <span class="mi">5</span> <span class="o">-&gt;</span> <span class="n">it</span><span class="mf">.2</span>
<span class="mi">2</span> <span class="mi">4</span> <span class="mi">3</span> <span class="mi">4</span> <span class="o">.</span> <span class="mi">8</span> <span class="mi">2</span> <span class="mi">2</span> <span class="o">.</span> <span class="o">-&gt;</span> <span class="n">it</span><span class="mf">.3</span>
<span class="mi">2</span> <span class="o">.</span> <span class="mi">2</span> <span class="mi">3</span> <span class="o">.</span> <span class="mi">4</span> <span class="mi">3</span> <span class="o">.</span> <span class="o">.</span> <span class="o">-&gt;</span> <span class="n">it</span><span class="mf">.4</span>
<span class="mi">3</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="mi">1</span> <span class="o">.</span> <span class="o">.</span> <span class="o">-&gt;</span> <span class="n">it</span><span class="mf">.5</span>
<span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="mi">5</span> <span class="o">.</span> <span class="o">.</span> <span class="o">-&gt;</span> <span class="n">it</span><span class="mf">.6</span>
<span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">-&gt;</span> <span class="ne">StopIteration</span>
</pre></div>
</div>
<p>A simple storage of the generated data would be to translate the array
structure shown above in 2d-array, where missing elements are encoded by
<code class="docutils literal notranslate"><span class="pre">np.nan</span></code> or masked in <code class="docutils literal notranslate"><span class="pre">MaskArray</span></code>-object. The disadvantage of this
approach is that it can severely overload memory if the number of masked
elements generated becomes very large, as in very large sampling. A
better approach is to store the elements in a compacted 1d-array like
this :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">2</span> <span class="o">-&gt;</span> <span class="n">samples_index</span>
<span class="o">-----------------------</span>
<span class="mi">4</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">2</span> <span class="mi">5</span> <span class="mi">4</span> <span class="mi">4</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">2</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="o">...</span> <span class="o">-&gt;</span> <span class="n">samples_index</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">2</span> <span class="o">...</span> <span class="o">-&gt;</span> <span class="n">assets_index</span>
<span class="o">-----------------------</span>
<span class="mi">4</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">2</span> <span class="mi">5</span> <span class="mi">4</span> <span class="mi">4</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">3</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">8</span> <span class="mi">4</span> <span class="o">...</span>
</pre></div>
</div>
<p>This format is lighter, but requires some index manipulation to easily
slice on generated data.</p>
<section id="advantages-of-generator-approach">
<h2>Advantages of generator approach<a class="headerlink" href="#advantages-of-generator-approach" title="Link to this heading">#</a></h2>
<p>At a first glimps, used generator approach in ReLife2 only encapsulates
lifetime generation routine in one objet that keeps in memory previous
states without recomputing them many times. It is exactly what basic
while loop did. But, it offers to advantages in comparison to a while
loop :</p>
<ul class="simple">
<li><p>It provides a convenient way to pass other generator routine without
creating another RenewalProcess class</p></li>
<li><p>It avoids code duplication (see init_loop and main_loop) : same
generation, only model changes. First generation has only to send its
results to main generator</p></li>
</ul>
<p><strong>Solutions</strong></p>
<p>Lifetime generators are first parametrized with : <code class="docutils literal notranslate"><span class="pre">nb_assets</span></code>,
<code class="docutils literal notranslate"><span class="pre">nb_samples</span></code>, <code class="docutils literal notranslate"><span class="pre">args</span></code>. It allows to keep in memory the expected
rvs_size depending on <code class="docutils literal notranslate"><span class="pre">nb_assets</span></code>,<code class="docutils literal notranslate"><span class="pre">nb_samples</span></code>, <code class="docutils literal notranslate"><span class="pre">args</span></code>.
Generators also knows <code class="docutils literal notranslate"><span class="pre">end_time</span></code> in order to slice uppon valid
lifetime values.</p>
<p>Generators receive an 1d of times then : - it yields variable number of
computed data - update data in an object</p>
<p>one stacks results :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">stacker</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="n">init</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">new</span> <span class="o">=</span> <span class="k">yield</span> <span class="n">init</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">new</span><span class="p">):</span>
            <span class="n">init</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">init</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">x</span><span class="p">))</span>


<span class="k">def</span><span class="w"> </span><span class="nf">generator</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">stacker</span><span class="p">):</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">try</span> <span class="p">:</span>
            <span class="n">lifetime</span> <span class="o">=</span> <span class="n">rvs</span> <span class="o">...</span>
            <span class="n">assets</span> <span class="o">=</span> <span class="o">...</span>
            <span class="n">stacker</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">lifetime</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">stacker</span>
            <span class="n">stacker</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">return</span>
</pre></div>
</div>
</section>
<section id="events-and-a0">
<h2><code class="docutils literal notranslate"><span class="pre">events</span></code> and <code class="docutils literal notranslate"><span class="pre">a0</span></code><a class="headerlink" href="#events-and-a0" title="Link to this heading">#</a></h2>
<p>The current implementation has <code class="docutils literal notranslate"><span class="pre">events</span></code> and <code class="docutils literal notranslate"><span class="pre">a0</span></code> providing data for
<code class="docutils literal notranslate"><span class="pre">ReplacementPolicyData</span></code>, which are used to construct lifetime data in
<code class="docutils literal notranslate"><span class="pre">to_lifetime_data</span></code>. However, this introduces cumbersome code in the
<code class="docutils literal notranslate"><span class="pre">sample</span></code> functionalities.</p>
<ul class="simple">
<li><p>if model is <code class="docutils literal notranslate"><span class="pre">LeftTruncated</span></code>, <code class="docutils literal notranslate"><span class="pre">a0</span></code> must be catch for
<code class="docutils literal notranslate"><span class="pre">delayed_model</span></code> only and added to generated lifetimes as a
rectification</p></li>
<li><p>if model is <code class="docutils literal notranslate"><span class="pre">AgeReplacementModel</span></code>, <code class="docutils literal notranslate"><span class="pre">events</span></code> that represents right
censoring indicators, is conditionned on <code class="docutils literal notranslate"><span class="pre">ar</span></code> values</p></li>
</ul>
<p>So, type checking on <code class="docutils literal notranslate"><span class="pre">model</span></code> is made combined with ugly numpy slicing
to retrieve correct sampled elements. One can propose easier approach
with generators : why not just writting those data inside the generation
process and not after it was made ?</p>
<p><strong>Solution :</strong></p>
<p>Generation process relies on <code class="docutils literal notranslate"><span class="pre">rvs</span></code> functionnality of <code class="docutils literal notranslate"><span class="pre">LifetimeModel</span></code>
objects and <code class="docutils literal notranslate"><span class="pre">a0</span></code> is an <code class="docutils literal notranslate"><span class="pre">args</span></code> of those model type. We can modify the
<code class="docutils literal notranslate"><span class="pre">rvs</span></code> function to directly generate rectified lifetimes by
incorporating <code class="docutils literal notranslate"><span class="pre">a0</span></code>: <code class="docutils literal notranslate"><span class="pre">self.baseline(*args,</span> <span class="pre">size=size)</span> <span class="pre">+</span> <span class="pre">a0</span></code>. This
way, we no longer need to check for the <code class="docutils literal notranslate"><span class="pre">LeftTruncated</span></code> model in the
<code class="docutils literal notranslate"><span class="pre">sample</span></code> function, as the lifetimes will be correctly generated with
their final values.</p>
<p>Next, we can handle <code class="docutils literal notranslate"><span class="pre">events</span></code> more straightforwardly. In the lifetime
generator routine, we can add a check for the model type and generate
<code class="docutils literal notranslate"><span class="pre">events</span></code> alongside lifetimes, given the <code class="docutils literal notranslate"><span class="pre">ar</span></code> values. The
<code class="docutils literal notranslate"><span class="pre">CountData</span></code> can be updated to include <code class="docutils literal notranslate"><span class="pre">events</span></code> data, which is
consistent with the <code class="docutils literal notranslate"><span class="pre">ReplacementPolicyData</span></code> interface.</p>
<p>With these modifications, the <code class="docutils literal notranslate"><span class="pre">to_lifetime_data</span></code> function no longer
needs to be specific for <code class="docutils literal notranslate"><span class="pre">ReplacementPolicyData</span></code> subtypes. Every
<code class="docutils literal notranslate"><span class="pre">RenewalData</span></code> can have a <code class="docutils literal notranslate"><span class="pre">to_lifetime_data</span></code> method, enhancing
coherence and consistency. This approach ensures that every <code class="docutils literal notranslate"><span class="pre">sample</span></code>
method of both <code class="docutils literal notranslate"><span class="pre">RenewalProcess</span></code> and <code class="docutils literal notranslate"><span class="pre">Policy</span></code> returns objects that
can be converted to lifetime data.</p>
</section>
<section id="sample-signature-and-args">
<h2><code class="docutils literal notranslate"><span class="pre">sample</span></code> signature and <code class="docutils literal notranslate"><span class="pre">args</span></code><a class="headerlink" href="#sample-signature-and-args" title="Link to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">sample</span></code> methods in both <code class="docutils literal notranslate"><span class="pre">RenewalProcess</span></code> objects and
<code class="docutils literal notranslate"><span class="pre">Policy</span></code>-like objects (see next example) result in a varying interface
due to the inclusion of <code class="docutils literal notranslate"><span class="pre">args</span></code>-like parameters. These parameters are
necessary to customize the associated model, reward, and/or discount. I
have identified two possible solutions to this problem:</p>
<ol class="arabic simple">
<li><p>Keep <code class="docutils literal notranslate"><span class="pre">sample</span></code> as part of the interface, but encapsulate <code class="docutils literal notranslate"><span class="pre">args</span></code>
values in a dictionary of type <code class="docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Any]</span></code> during object
instantiation. The downside of this approach is that users must
provide each argument value during instantiation, along with
<code class="docutils literal notranslate"><span class="pre">model</span></code>, <code class="docutils literal notranslate"><span class="pre">reward</span></code>, and/or <code class="docutils literal notranslate"><span class="pre">discount</span></code> instances.</p></li>
<li><p>Remove <code class="docutils literal notranslate"><span class="pre">sample</span></code> from the interface and make it a standalone
function (<code class="docutils literal notranslate"><span class="pre">sample(obj,</span> <span class="pre">nb_sample=10,</span> <span class="pre">...)</span></code>) or a method within
another object, such as <code class="docutils literal notranslate"><span class="pre">Simulator</span></code>.</p></li>
</ol>
<p>The second solution, however, still requires varying <code class="docutils literal notranslate"><span class="pre">sample</span></code>
parametrization depending on the type of object (<code class="docutils literal notranslate"><span class="pre">obj</span></code>) passed as the
first argument. If <code class="docutils literal notranslate"><span class="pre">obj</span></code> is a <code class="docutils literal notranslate"><span class="pre">RenewalProcess</span></code>, <code class="docutils literal notranslate"><span class="pre">args</span></code> would
correspond to <code class="docutils literal notranslate"><span class="pre">model_args</span></code> and optionally <code class="docutils literal notranslate"><span class="pre">delayed_model_args</span></code>. If
<code class="docutils literal notranslate"><span class="pre">obj</span></code> is a <code class="docutils literal notranslate"><span class="pre">RunToFailure</span></code>, <code class="docutils literal notranslate"><span class="pre">args</span></code> would include <code class="docutils literal notranslate"><span class="pre">cp</span></code>, <code class="docutils literal notranslate"><span class="pre">cf</span></code>,
<code class="docutils literal notranslate"><span class="pre">rate</span></code>, <code class="docutils literal notranslate"><span class="pre">cp1</span></code>, and so on. Although this approach could be
implemented using single dispatch from <code class="docutils literal notranslate"><span class="pre">functools</span></code>, it may not be
user-friendly, as understanding the various parametrization options
would require consulting the documentation.</p>
<p>The first approach could be implemented using a <code class="docutils literal notranslate"><span class="pre">Protocol</span></code> to define a
clear and concise <code class="docutils literal notranslate"><span class="pre">Policy</span></code> type.`</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">Policy</span><span class="p">(</span><span class="n">Protocol</span><span class="p">):</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">LifetimeModel</span><span class="p">[</span><span class="o">*</span><span class="n">ModelArgs</span><span class="p">],</span>
    <span class="n">model_args</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="o">*</span><span class="n">ModelArgs</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[()]</span> <span class="o">=</span> <span class="p">(),</span>
    <span class="n">reward_args</span> <span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
    <span class="n">nb_assets</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">a0</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">delayed_model</span><span class="p">:</span> <span class="n">LifetimeModel</span><span class="p">[</span><span class="o">*</span><span class="n">DelayedModelArgs</span><span class="p">],</span>
    <span class="n">delayed_model_args</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="o">*</span><span class="n">DelayedModelArgs</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[()]</span> <span class="o">=</span> <span class="p">(),</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">expected_total_cost</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeline</span> <span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]:</span> <span class="o">...</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">asymptotic_expected_total_cost</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]:</span> <span class="o">...</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">expected_equivalent_annual_cost</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeline</span> <span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]:</span> <span class="o">....</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">asymptotic_expected_equivalent_annual_cost</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]:</span> <span class="o">...</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">sample</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nb_samples</span> <span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="o">...</span>
</pre></div>
</div>
<p>The issue of <code class="docutils literal notranslate"><span class="pre">args</span></code> in <code class="docutils literal notranslate"><span class="pre">sample</span></code> has been addressed by storing them
as a dictionary of values. Every method will retrieve the required arg
values from this dictionary. From a user’s perspective, every concrete
<code class="docutils literal notranslate"><span class="pre">Policy</span></code> will explicitly state the names of the <code class="docutils literal notranslate"><span class="pre">args</span></code> needed in
<code class="docutils literal notranslate"><span class="pre">reward_args</span></code>. Only the core of the constructor will fill the
dictionary. This attribute could even be a descriptor to automatically
control and convert filled <code class="docutils literal notranslate"><span class="pre">args</span></code> values with respect to
<code class="docutils literal notranslate"><span class="pre">nb_assets</span></code>.</p>
<p>One drawback of solution 2 is that it is more aligned with the
object-oriented paradigm and may be less appealing to users who prefer
functional programming. It is true that this approach requires users to
reinstantiate the <code class="docutils literal notranslate"><span class="pre">Policy</span></code>-like object each time they want to change
<code class="docutils literal notranslate"><span class="pre">args</span></code>. However, this only adds one additional line of code compared
to calling <code class="docutils literal notranslate"><span class="pre">sample</span></code> with different arguments. Furthermore, the number
of given args is significant, and it is likely that users would have
already stored them in variables. It is merely a matter of copying and
pasting the relevant variables when reinstantiating the object.</p>
<p>NB : <code class="docutils literal notranslate"><span class="pre">Policy</span></code> objects do not need nor <code class="docutils literal notranslate"><span class="pre">reward</span></code> or <code class="docutils literal notranslate"><span class="pre">discount</span></code>
attribute. Discount is always exponential and <code class="docutils literal notranslate"><span class="pre">reward</span></code> is implicit.</p>
</section>
</section>


                </article>
              
              
              
              
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#advantages-of-generator-approach">Advantages of generator approach</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#events-and-a0"><code class="docutils literal notranslate"><span class="pre">events</span></code> and <code class="docutils literal notranslate"><span class="pre">a0</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sample-signature-and-args"><code class="docutils literal notranslate"><span class="pre">sample</span></code> signature and <code class="docutils literal notranslate"><span class="pre">args</span></code></a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/contributor_guide/about_stochastic_process.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2025, RTE.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.0.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>